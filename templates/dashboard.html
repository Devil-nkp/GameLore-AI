{% extends "base.html" %}
{% block content %}
<div class="max-w-6xl mx-auto">
    
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
        <div class="glass p-6 rounded-2xl flex items-center gap-4 col-span-2">
            <div class="w-16 h-16 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-2xl font-bold border-2 border-white/20">
                {{ user.name[0] }}
            </div>
            <div>
                <h2 class="text-2xl font-bold text-white">{{ user.name }}</h2>
                <div class="flex items-center gap-2 text-slate-400">
                    <span class="bg-slate-700 px-2 py-0.5 rounded text-xs uppercase tracking-wider">
                        {% if user.is_pro %}PRO CREATOR{% else %}Free Tier{% endif %}
                    </span>
                    <span>‚Ä¢</span>
                    <span>{{ user.email }}</span>
                </div>
            </div>
        </div>

        <div class="glass p-6 rounded-2xl flex flex-col justify-center relative overflow-hidden group">
            <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition">
                <svg class="w-24 h-24" fill="currentColor" viewBox="0 0 20 20"><path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"></path></svg>
            </div>
            <div class="flex justify-between items-end mb-2">
                <span class="text-slate-400 font-bold uppercase text-sm">Credits Available</span>
                <span class="text-3xl font-mono font-bold text-white">{{ user.credits }}</span>
            </div>
            <div class="w-full bg-slate-700 h-2 rounded-full overflow-hidden">
                <div class="bg-green-400 h-full" style="width: {{ (user.credits / 10) * 100 }}%"></div>
            </div>
            {% if not user.is_pro %}
            <a href="/payment" class="mt-3 text-xs text-center text-green-400 hover:text-green-300 font-bold">Top Up Credits ‚Üí</a>
            {% endif %}
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        
        <div class="glass p-6 rounded-2xl h-fit">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-white">Your Legacy</h3>
                <span class="text-yellow-400 font-bold">{{ user.xp }} XP</span>
            </div>
            
            <div class="space-y-4">
                {% if badges %}
                    {% for badge in badges %}
                    <div class="flex items-center gap-3 bg-slate-800/50 p-3 rounded-xl border border-slate-700/50">
                        <div class="text-2xl">üèÜ</div>
                        <div>
                            <div class="font-bold text-slate-200">{{ badge }}</div>
                            <div class="text-xs text-slate-500">Unlocked achievement</div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="text-center py-8 text-slate-500">
                        <p class="mb-2">No badges yet.</p>
                        <p class="text-sm">Generate content to earn XP!</p>
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="lg:col-span-2">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-white">Recent Creations</h3>
                <a href="/generate" class="text-sm text-purple-400 hover:text-purple-300">Create New +</a>
            </div>

            <div class="space-y-4">
                {% if recent_gens %}
                    {% for gen in recent_gens %}
                    <div class="glass p-5 rounded-xl border border-slate-700 hover:border-purple-500/50 transition group">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-xs font-bold text-pink-400 bg-pink-400/10 px-2 py-1 rounded uppercase tracking-wider">{{ gen.type }}</span>
                            <span class="text-xs text-slate-500">{{ gen.timestamp.strftime('%Y-%m-%d') }}</span>
                        </div>
                        <p class="text-slate-300 text-sm line-clamp-2 mb-4">{{ gen.content[:150] }}...</p>
                        
                        <div class="flex gap-3 opacity-50 group-hover:opacity-100 transition">
                            <a href="/export/{{ gen.id }}" class="text-xs flex items-center gap-1 text-slate-400 hover:text-white">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                                JSON
                            </a>
                            <button class="text-xs flex items-center gap-1 text-indigo-400 hover:text-indigo-300" hx-post="/share_discord/{{ gen.id }}" hx-swap="outerHTML">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M20.317 4.37a19.791 19.791 0 00-4.885-1.515.074.074 0 00-.079.037 13.48 13.48 0 00-.59 1.203 18.23 18.23 0 00-7.163 0 13.525 13.525 0 00-.59-1.203.078.078 0 00-.079-.037 19.796 19.796 0 00-4.885 1.515.071.071 0 00-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 00.031.057 19.9 19.9 0 005.993 3.03.078.078 0 00.084-.028 14.09 14.09 0 001.226-1.994.076.076 0 00-.041-.106 13.107 13.107 0 01-1.872-.892.077.077 0 01-.008-.128 10.2 10.2 0 00.372-.292.074.074 0 01.077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 01.078.01c.12.098.246.198.373.292a.077.077 0 01-.006.127 12.299 12.299 0 01-1.873.892.077.077 0 00-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 00.084.028 19.839 19.839 0 006.002-3.03.077.077 0 00.032-.054c.5-5.177-.838-9.674-3.549-13.66a.074.074 0 00-.031-.028z"/></svg>
                                Share
                            </button>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="glass p-8 rounded-xl text-center border border-dashed border-slate-700">
                        <p class="text-slate-400 mb-4">You haven't generated anything yet.</p>
                        <a href="/generate" class="bg-purple-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-purple-700 transition">Start Creating</a>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
