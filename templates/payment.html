{% extends "base.html" %}
{% block content %}
<div class="text-center mb-5">
    <h2>Upgrade Your Arsenal</h2>
    <p>Choose the plan that fits your development cycle.</p>
</div>

<div class="row justify-content-center">
    <div class="col-md-4">
        <div class="card p-4 mb-4 text-center">
            <h3>Credit Pack</h3>
            <h1 class="display-5">$29</h1>
            <p>One-time payment</p>
            <ul class="list-unstyled mb-4">
                <li>5 Credits</li>
                <li>Lifetime validity</li>
                <li>Email Support</li>
            </ul>
            <button class="btn btn-outline-primary w-100" id="btn-pack">Buy Pack</button>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card p-4 mb-4 text-center border-primary shadow">
            <h3>Pro Studio</h3>
            <h1 class="display-5">$49<small class="fs-6 text-muted">/mo</small></h1>
            <p>Recurring billing</p>
            <ul class="list-unstyled mb-4">
                <li><strong>Unlimited</strong> Generations</li>
                <li>Priority Processing</li>
                <li>Commercial License</li>
            </ul>
            <button class="btn btn-primary w-100" id="btn-sub">Subscribe</button>
        </div>
    </div>
</div>

<script src="https://js.stripe.com/v3/"></script>
<script>
    var stripe = Stripe('{{ key }}');
    
    function checkout(type) {
        fetch('/create-checkout-session', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ type: type })
        })
        .then(function(response) { return response.json(); })
        .then(function(session) {
            return stripe.redirectToCheckout({ sessionId: session.id });
        })
        .then(function(result) {
            if (result.error) { alert(result.error.message); }
        });
    }

    document.getElementById('btn-pack').addEventListener('click', function() { checkout('pack'); });
    document.getElementById('btn-sub').addEventListener('click', function() { checkout('sub'); });
</script>
{% endblock %}
